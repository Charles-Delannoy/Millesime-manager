<%= link_to bottle_path(bottle), class: "cave-show-card-link" do %>
  <% unless bottle.quantity == 0 %>
    <div class="cave-show-wine-card cave-card-color">
      <div class="wine-image">
        <%= cl_image_tag bottle.wine.photo.key, class: "cave-show-wine-img" %>
      </div>
      <div class="cave-show-wine-information">
        <div class="cave-show-wine-title">
          <h1><strong><%= bottle.wine.name %></strong></h1>
        </div>
        <div class="cave-show-wine-description">
          <h3> <strong>Region:</strong> <%= bottle.wine.appelation.region.name %> </h3>
          <h3> <strong>Appelation:</strong> <%= bottle.wine.appelation.name %> </h3>
          <h3> <strong>Qty: <%= bottle.quantity %> </strong></h3>
        </div>


        <% now_diff = Time.now.year - bottle.wine.apogee_start %>
        <% apogee_duration = bottle.wine.apogee_end - bottle.wine.apogee_start + 1 %>
        <% percentage = (now_diff < 0) ? 0 : ((now_diff+1).to_f/apogee_duration)*100 %>

        <div class="wine-apogee">
          <h3><%= bottle.wine.apogee_start %></h3>
          <div class="progress">
            <div class="progress-bar" style="width:<%= percentage.to_i %>%;" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
            </div>
          </div>
          <h3><%= bottle.wine.apogee_end %></h3>
        </div>
      </div>
      <div class="take-bottle-out">
        <%= link_to '<i class="fas fa-minus"></i>'.html_safe, edit_bottle_path(bottle), id:"favicon-add-cave" %>
      </div>
    </div>
  <% end %>
<% end %>
